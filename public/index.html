<!doctype html>
<html>
  <head>
    <title>WebSocket Stream Client</title>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  </head>
  <body>
    <h2>WebSocket Position Stream</h2>
    <button onclick="startStream()">Start Stream</button>
    <button onclick="stopStream()">Stop Stream</button>

    <div id="log"></div>

    <script>
      const socket = io('http://localhost:3000'); // ì„œë²„ ì£¼ì†Œ ë³€ê²½ ê°€ëŠ¥

      socket.on('connect', () => {
        log('âœ… Connected to server');
      });

      socket.on('disconnect', () => {
        log('âŒ Disconnected from server');
      });

      socket.on('position', ({ x, y, outlier }) => {
        if (outlier) {
          log(`ğŸš¨ Outlier! x: ${x.toFixed(2)}, y: ${y.toFixed(2)}`);
        } else {
          log(`ğŸ“ x: ${x.toFixed(2)}, y: ${y.toFixed(2)}`);
        }
      });

      socket.on('stopped', () => {
        log('ğŸ›‘ Stream stopped by server');
      });

      function startStream() {
        socket.emit('start-stream', {
          xMin: 0, // x min
          xMax: 100, // x max
          yMin: 0, // y min
          yMax: 100, // y max
          fps: 10, // ìœ„ì¹˜ ì „ì†¡ ì£¼ê¸° (1ì´ˆì— 2ë²ˆ)
          outlierRate: 10, // ì´ìƒì¹˜ ë°œìƒ í™•ë¥  (10%)
          outlierMultiplier: 5, // ì´ìƒì¹˜ ë°°ìˆ˜
        });
      }

      function stopStream() {
        socket.emit('stop-stream');
      }

      function log(message) {
        const logDiv = document.getElementById('log');
        const entry = document.createElement('div');
        entry.textContent = message;
        logDiv.appendChild(entry);
      }
    </script>
  </body>
</html>
